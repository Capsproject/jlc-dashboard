import{a as i,b as g}from"./chunk-4U4QGEFV.js";import{a,i as l}from"./chunk-MZ4IBQOD.js";import{Ea as c,K as u,N as n,T as o,g as s}from"./chunk-DSI57U6V.js";var p=(()=>{class e{http=o(a);url=i.apiUrl;onLogin(t){return this.http.post(this.url+"auth/login",t,{observe:"response"})}logout(){return this.http.get(this.url+"auth/logout",{observe:"response"})}static \u0275fac=function(r){return new(r||e)};static \u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var h=(()=>{class e{getToken(){return window.localStorage[i.tokenName]}saveToken(t,r){window.localStorage[i.tokenName]=t,window.localStorage.user=r}destroyToken(){window.localStorage.removeItem(i.tokenName)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var N=(()=>{class e{currentUserSubject=new s(null);userDetails=new s({});userDetails$=this.userDetails.asObservable();userInfo;_isLoggedIn$=new s(!1);http=o(a);jwtService=o(h);router=o(l);_alertService=o(g);loginS=o(p);isLoggedIn$=this._isLoggedIn$.asObservable();user=c(null);get token(){return localStorage.getItem("user")||""}constructor(){this._isLoggedIn$.next(!!this.token),this.userInfo=localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")||"{}"):{}}isLogIn(){return this.isLoggedIn$}userDetail(){return this.userDetails$}logout(){this.loginS.logout(),this.purgeAuth(),this.router.navigate(["/auth/login"])}get currenctUserValue(){return this.currentUserSubject.value}setAuth(t){this.jwtService.saveToken(t.token,t.user),localStorage.setItem("user",JSON.stringify(t.user)),this.user.set(t.user),this.userInfo=t.user,this.currentUserSubject.next(t.user),this._isLoggedIn$.next(!0)}purgeAuth(){this.jwtService.destroyToken(),this.currentUserSubject.next(null),localStorage.removeItem("user")}update(t){return this.http.put("/user",{user:t}).pipe(u(({user:r})=>{this.currentUserSubject.next(r)}))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=n({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();export{p as a,N as b};
